# Broken Access Control

**Broken access control vulnerability** is a security flaw that allows unauthorized users to access, modify, or delete data they shouldnâ€™t have access to. This vulnerability is considered one of the most critical web application security risks. It occurs when an application fails to properly enforce access controls, allowing attackers to bypass authorization and perform tasks as if they were a legitimate user.

The Open Web Application Security Project (OWASP) lists broken access control as the #1 critical web application security risk. According to OWASP, common access control vulnerabilities include:

### Violation of the Principle of Least Privilege or Deny by Default
- Access should only be granted for particular capabilities, roles, or users, but is available to anyone.

#### Common Examples of Violations:
- **Overly permissive group permissions**: When a group is given broad access to resources or capabilities, all members of that group inherit those permissions, regardless of their individual needs.
- **Default "everyone" permissions**: Some systems or applications may default to granting access to "everyone" or the "world", meaning anyone can access resources without explicit permission.
- **Lack of role-based access control (RBAC)**: RBAC is a system that assigns permissions based on a user's role or function within an organization. If RBAC is not implemented or not enforced properly, users may have unnecessary access.
- **Insufficient auditing and monitoring**: Without proper auditing and monitoring, it can be difficult to detect and address violations of the principle of least privilege.

### Bypassing Access Control Checks
- **URL Manipulation**: 
  - **Parameter Tampering**: Altering parameters within a URL to trigger unintended actions or access restricted content. For example, changing a product ID to access a product that is normally hidden.
  - **Force Browsing**: Directly entering a URL that bypasses normal authentication or authorization checks. This can be exploited if the application doesn't properly validate input or handle unauthorized requests.
- **Internal Application State Modification**: 
  - **Session Hijacking**: Stealing a valid session ID to impersonate a legitimate user. This can be achieved through various methods, such as network sniffing or cross-site scripting (XSS).
  - **Cookie Manipulation**: Modifying or forging cookies to gain unauthorized access. This can be done through browser extensions or by exploiting vulnerabilities in the application's cookie handling.
- **HTML Page Manipulation**:
  - **XSS**: Injecting malicious code into a web page to execute arbitrary scripts. This can be used to steal user credentials, redirect users to malicious websites, or compromise the application's functionality.
  - **Client-Side Attacks**: Exploiting vulnerabilities in client-side JavaScript or other technologies to bypass security checks or execute unauthorized actions.
- **API Request Modification**:
  - **API Key Exposure**: Exposing API keys or tokens that allow unauthorized access to the API. This can happen through insecure storage, accidental disclosure, or vulnerabilities in the application's code.
  - **API Abuse**: Misusing API endpoints or sending invalid requests to bypass rate limits or other security measures.
  - **Permitting viewing or editing someone else's account** by providing its unique identifier (insecure direct object references).
  - **Accessing API with missing access controls for POST, PUT and DELETE**.
  - **Elevation of privilege**: Acting as a user without being logged in or acting as an admin when logged in as a user.
  - **Metadata manipulation**: Such as replaying or tampering with a JSON Web Token (JWT) access control token, or a cookie or hidden field manipulated to elevate privileges or abusing JWT invalidation.
  - **CORS misconfiguration**: Allows API access from unauthorized/untrusted origins.
  - **Force browsing**: To authenticated pages as an unauthenticated user or to privileged pages as a standard user.
